<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/2000/REC-xhtml1-20000126/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <script type="text/javascript">
        var key = "";
        function encode(s) {
            return s.replace(/&/g, "&").replace(/</g, "<").replace(/>/g, ">").replace(/([\\\.\*\[\]\(\)\$\^])/g, "\\$1");
        }
        function decode(s) {
            return s.replace(/\\([\\\.\*\[\]\(\)\$\^])/g, "$1").replace(/>/g, ">").replace(/</g, "<").replace(/&/g, "&");
        }
        function highlight(s) {
            s = encode(s);
            var obj = parent.right.document.getElementsByTagName("body")[0];
            var t = obj.innerHTML.replace(/<span\s+class=.?highlight.?>([^<>]*)<\/span>/gi, "$1");
            obj.innerHTML = t;
            var cnt = loopSearch(s, obj);
            t = obj.innerHTML
            var r = /{searchHL}(({(?!\/searchHL})|[^{])*){\/searchHL}/g
            t = t.replace(r, "<span class='highlight'>$1</span>");
            obj.innerHTML = t;
        }
        function loopSearch(s, obj) {
            var cnt = 0;
            if (obj.nodeType == 3) {
                cnt = replace(s, obj);
                return cnt;
            }
            for (var i = 0, c; c = obj.childNodes[i]; i++) {
                if (!c.className || c.className != "highlight")
                    cnt += loopSearch(s, c);
            }
            return cnt;
        }
        function replace(s, dest) {
            var r = new RegExp(s, "g");
            var tm = null;
            var t = dest.nodeValue;
            var cnt = 0;
            if (tm = t.match(r)) {
                cnt = tm.length;
                t = t.replace(r, "{searchHL}" + decode(s) + "{/searchHL}")
                dest.nodeValue = t;
            }
            return cnt;
        }

        var pages = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27];
        var pagenames = ["封面","1 引言","1.1 编写目的","1.2 背景","1.3 定义","1.4 参考资料","2 用途","2.1 功能","2.2 性能","2.2.1 时间特性","2.2.2 灵活性","2.3 安全保密","3 运行环境","3.1 硬件设备","3.2 支持软件","4 使用过程","4.1 安装与初始化","4.2 出错处理和恢复","4.3 终端操作","4.3.1 查看太阳系模型","4.3.3.1 位置类变换：","4.3.3.2 试图变换：","4.3.2 查看日食","4.3.3 查看行星连珠","4.3.4 其他","4.4 卸载","5 附录"];
        var currentpage = 0;


        function PageLoad(con) {
            if (con.src == "about:blank")
                return;

            var s = document.getElementById("s").value;
            var obj = content.document.getElementsByTagName("body")[0];
            var t = obj.innerHTML.replace(/<span\s+class=.?highlight.?>([^<>]*)<\/span>/gi, "$1");
            obj.innerHTML = t;
            var cnt = loopSearch(s, obj);
            if (cnt > 0) {
                jsAddItemToSelect(files, pagenames[currentpage], pages[currentpage]);
            }
            if (currentpage < pages.length - 1) {
                currentpage++;
                initPage(currentpage);
            }
            else {
            }
        }


        function initPage(i) {
            currentpage = i;
            document.getElementById("content").src = pages[i] + ".html";
        }


        function jsAddItemToSelect(objSelect, objItemText, objItemValue) {
            var varItem = new Option(objItemText, objItemValue);
            objSelect.options.add(varItem);
        }

        function Goto(files) {
            if (files.selectedIndex >= 0) {
                var pageId = files.value;
                open(pageId + ".html", "right");
            }
        }

        function StartSearch() {
            key = s.value;
            files.options.length = 0;
            if (key != "") {
                initPage(0);
            } else
            { alert('请输入关键字！'); }
        }
    </script>

    <style type="text/css">
        html, body
        {
            height: 100%;
            background-color: #bfdfff;
            padding: 0px;
            margin: 0px;
            font-size: 12px;
        }
        #s
        {
            width: 98px;
        }
        TABLE
        {
            font-size: 12px;
        }
        A:link
        {
            font-style: normal;
            color: #333333;
            font-weight: normal;
            text-decoration: none;
        }
        A:visited
        {
            color: #333333;
            text-decoration: none;
        }
        A:hover
        {
            color: #3375ce;
            text-decoration: none;
        }
        A:active
        {
            color: #005ab5;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <table style="border: 1px solid #ccc; height: 85%; width: 100%" cellspacing="0">
        <tr>
            <td style="background-color: #BFDFFF; height: 5px" colspan="2">
            </td>
        </tr>
        <tr style="height: 25px">
            <td style="background-color: #BFDFFF; border: 0px solid #ccc; border-bottom-width: 1px;
                border-right-width: 0px" align="center">
                <a href="list.html">目录</a>
            </td>
            <td style="background-color: #fff; border: 1px solid #ccc; border-bottom-width: 0px;
                border-right-width: 0px" align="center">
                搜索
            </td>
        </tr>
        <tr>
            <td colspan="2" style="height: 100%;background-color: #fff">
                <table style="height: 100%; width: 100%">
                    <tr>
                        <td style="height: 20px">
                            <input name="s" id="s" title="关键词" /> <input type="button" value="搜索" onclick="StartSearch();" />
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 100%; border: 1px solid #cccccc">
                            <select multiple="multiple" id="files" onclick="Goto(this)" style="height: 100%;
                                width: 100%">
                            </select>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <iframe id="content" onload="PageLoad(this);" src="about:blank" name="content" style="width: 0px;
        height: 0px"></iframe>
</body>
</html>

